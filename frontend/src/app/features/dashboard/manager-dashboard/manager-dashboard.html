<div class="manager-container">
    <header>
        <h1>Panel de Manager üëî</h1>
        <p>Gesti√≥n de equipo y control personal</p>
    </header>

    <section class="personal-actions">
        <h2>Mi Asistencia</h2>
        <div class="actions-grid">
            <button class="btn-action" (click)="irAMarcar()">
                üìç Registrar Entrada/Salida
            </button>
            <button class="btn-info" (click)="irAHistorial()">
                üìÖ Mi Historial
            </button>
        </div>
    </section>

    <hr>

    <section class="team-overview">
        <h2>Actividad de mi Equipo (Hoy)</h2>

        <div *ngIf="cargando">Cargando equipo...</div>
        <div *ngIf="!cargando && equipoLogs.length === 0">
            Nadie de tu equipo ha marcado hoy.
        </div>

        <table *ngIf="equipoLogs.length > 0">
            <thead>
                <tr>
                    <th>Empleado</th>
                    <th>Evento</th>
                    <th>Hora</th>
                    <th>Ubicaci√≥n</th>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let log of equipoLogs">
                    <td>
                        <div class="empleado-cell" style="display: flex; align-items: center; gap: 10px;">
                            <img *ngIf="log.empleado_info?.foto_url" [src]="log.empleado_info.foto_url"
                                style="width: 30px; height: 30px; border-radius: 50%; object-fit: cover;">
                            <span *ngIf="!log.empleado_info?.foto_url">üë§</span>

                            <div>
                                <strong>{{ log.empleado_info?.nombres }} {{ log.empleado_info?.apellidos }}</strong>
                                <br>
                                <small style="color: gray;">ID: {{ log.empleado_info?.id }}</small>
                            </div>
                        </div>
                    </td>

                    <td>
                        <span [class.chk-in]="log.tipo === 'CHECK_IN'" [class.chk-out]="log.tipo === 'CHECK_OUT'"
                            style="padding: 4px 8px; border-radius: 4px; font-weight: bold;">
                            {{ log.tipo === 'CHECK_IN' ? 'Entrada' : 'Salida' }}
                        </span>
                    </td>

                    <td>
                        {{ log.registrado_el | date:'shortTime' }}
                    </td>

                    <td>
                        <a *ngIf="log.gps_lat"
                            [href]="'https://www.google.com/maps/search/?api=1&query=' + log.gps_lat + ',' + log.gps_lng"
                            target="_blank" style="text-decoration: none;">
                            üó∫Ô∏è Ver
                        </a>
                    </td>
                </tr>
            </tbody>
        </table>
    </section>
    <section class="approvals-section" *ngIf="solicitudesPendientes.length > 0">
        <h2 style="color: #d9534f;">‚ö†Ô∏è Solicitudes Pendientes ({{ solicitudesPendientes.length }})</h2>

        <div class="cards-container">
            <div *ngFor="let sol of solicitudesPendientes" class="approval-card">
                <div class="header">
                    <strong>{{ sol.empleado_info?.nombres }} {{ sol.empleado_info?.apellidos }}</strong> pide:
                    <span class="badge">{{ sol.nombre_tipo }}</span>
                </div>

                <p class="dates">
                    üìÖ Del {{ sol.fecha_inicio | date }} al {{ sol.fecha_fin | date }}
                    ({{ sol.dias_solicitados }} d√≠as)
                </p>

                <p class="motivo">"{{ sol.motivo }}"</p>

                <div class="actions">
                    <button (click)="gestionarSolicitud(sol.id, 'APROBADO')" class="btn-approve">‚úÖ Aprobar</button>
                    <button (click)="gestionarSolicitud(sol.id, 'RECHAZADO')" class="btn-reject">‚ùå Rechazar</button>
                </div>
            </div>
        </div>
        <hr>
    </section>
</div>