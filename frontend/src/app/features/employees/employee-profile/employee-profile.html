<div class="profile-container" *ngIf="!cargando && empleado">

    <div class="top-bar">
        <button class="btn-back" (click)="volver()">‚Üê Volver al Directorio</button>
    </div>

    <div class="profile-layout">

        <aside class="profile-card">
            <div class="card-header">
                <div class="avatar-large">
                    <img *ngIf="empleado.foto_url" [src]="empleado.foto_url" alt="Foto">
                    <span *ngIf="!empleado.foto_url">{{ empleado.nombres.charAt(0) }}{{ empleado.apellidos.charAt(0)
                        }}</span>
                </div>

                <h2>{{ empleado.nombres }} {{ empleado.apellidos }}</h2>
                <p class="role-text">{{ empleado.puesto?.nombre || 'Sin Cargo' }}</p>

                <div class="status-badge">ACTIVO</div>
            </div>

            <div class="card-body">
                <div class="contact-item">
                    <span class="icon">‚úâÔ∏è</span>
                    <span>{{ empleado.email }}</span>
                </div>
                <div class="contact-item">
                    <span class="icon">üìû</span>
                    <span>{{ empleado.telefono || '0984123102' }}</span>
                </div>
                <div class="contact-item">
                    <span class="icon">üåê</span>
                    <span>GMT -05:00</span>
                </div>

                <hr class="divider">

                <div class="hierarchy-info">
                    <div class="hierarchy-item">
                        <small>Departamento</small>
                        <p>{{ empleado.unidad?.nombre || 'General' }}</p>
                    </div>
                    <div class="hierarchy-item">
                        <small>Oficina</small>
                        <p>Sede Central</p>
                    </div>
                    <div class="hierarchy-item" *ngIf="empleado.manager">
                        <small>Jefe Directo</small>
                        <div class="manager-chip">
                            <div class="mini-avatar">M</div>
                            <span>{{ empleado.manager.nombres }} {{ empleado.manager.apellidos }}</span>
                        </div>
                    </div>
                </div>

                <button class="btn-action">Acci√≥n ‚ñæ</button>
            </div>
        </aside>


        <main class="details-card">

            <nav class="tabs-nav">
                <button [class.active]="activeTab === 'general'" (click)="cambiarTab('general')">General</button>
                <button [class.active]="activeTab === 'cargo'" (click)="cambiarTab('cargo')">Cargo</button>
                <button [class.active]="activeTab === 'nomina'" (click)="cambiarTab('nomina')">N√≥mina</button>
                <button [class.active]="activeTab === 'documentos'"
                    (click)="cambiarTab('documentos')">Documentos</button>
                <button [class.active]="activeTab === 'config'" (click)="cambiarTab('config')">Configuraci√≥n</button>
            </nav>

           <div class="tab-content" *ngIf="activeTab === 'general'">

    <section class="info-section">
        <div class="section-header">
            <h3>Informaci√≥n personal</h3>
            <button class="btn-icon" *ngIf="puedeEditar" (click)="abrirEdicion('personal')">‚úèÔ∏è</button>
        </div>

        <div class="info-grid">
            <div class="info-group">
                <label>Nombre completo</label>
                <p>{{ empleado.nombres }} {{ empleado.apellidos }}</p>
            </div>
            <div class="info-group">
                <label>G√©nero</label>
                <p>{{ empleado.genero || 'No definido' }}</p>
            </div>
            <div class="info-group">
                <label>Fecha de nacimiento</label>
                <p>{{ empleado.fecha_nacimiento | date:'dd MMM yyyy' }}</p>
            </div>
            <div class="info-group">
                <label>Estado civil</label>
                <p>{{ empleado.estado_civil || 'No definido' }}</p>
            </div>
            <div class="info-group">
                <label>Nacionalidad</label>
                <p>{{ empleado.nacionalidad || 'Ecuatoriana' }}</p>
            </div>
            <div class="info-group">
                <label>Correo electr√≥nico</label>
                <p>{{ empleado.email }}</p>
            </div>
            <div class="info-group">
                <label>N√∫mero de celular</label>
                <p>{{ empleado.telefono || 'Sin registrar' }}</p>
            </div>
        </div>
    </section>

    <section class="info-section">
        <div class="section-header">
            <h3>Direcci√≥n</h3>
            <button class="btn-icon" *ngIf="puedeEditar" (click)="abrirEdicion('direccion')">‚úèÔ∏è</button>
        </div>
        <div class="info-grid">
            <div class="info-group">
                <label>Direcci√≥n principal</label>
                <p>{{ empleado.direccion || 'Sin direcci√≥n' }}</p>
            </div>
            <div class="info-group">
                <label>Pa√≠s</label>
                <p>{{ empleado.pais || 'Ecuador' }}</p>
            </div>
            <div class="info-group">
                <label>Ciudad</label>
                <p>{{ empleado.ciudad || 'No definida' }}</p>
            </div>
        </div>
    </section>
</div>

            <div class="tab-content" *ngIf="activeTab !== 'general'">
                <p class="empty-msg">Contenido de {{ activeTab }} pr√≥ximamente...</p>
            </div>

        </main>
    </div>

    <div class="modal-overlay" *ngIf="showModal">
    <div class="modal-content">
        <div class="modal-header">
            <h3>Editar {{ seccionEditando | titlecase }}</h3>
            <button class="btn-close" (click)="cerrarModal()">√ó</button>
        </div>

        <form [formGroup]="editForm" (ngSubmit)="guardarCambios()">
            <div class="modal-body">
                <ng-container *ngIf="seccionEditando === 'personal'">
                    <div class="form-row">
                        <div class="form-group">
                            <label>Nombres</label>
                            <input formControlName="nombres">
                        </div>
                        <div class="form-group">
                            <label>Apellidos</label>
                            <input formControlName="apellidos">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>G√©nero</label>
                            <select formControlName="genero">
                                <option value="Masculino">Masculino</option>
                                <option value="Femenino">Femenino</option>
                                <option value="Otro">Otro</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Estado Civil</label>
                            <select formControlName="estado_civil">
                                <option value="Soltero/a">Soltero/a</option>
                                <option value="Casado/a">Casado/a</option>
                                <option value="Divorciado/a">Divorciado/a</option>
                            </select>
                        </div>
                    </div>
                </ng-container>

                <ng-container *ngIf="seccionEditando === 'direccion'">
                    <div class="form-group">
                        <label>Direcci√≥n Principal</label>
                        <input formControlName="direccion">
                    </div>
                    <div class="form-group">
                        <label>Ciudad</label>
                        <input formControlName="ciudad">
                    </div>
                </ng-container>
            </div>

            <div class="modal-footer">
                <button type="button" class="btn-secondary" (click)="cerrarModal()">Cancelar</button>
                <button type="submit" class="btn-primary" [disabled]="editForm.invalid">Guardar Cambios</button>
            </div>
        </form>
    </div>
</div>
</div>