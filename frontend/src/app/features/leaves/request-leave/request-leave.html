<div class="leave-container">
    <h2>Solicitar Permiso / Vacaciones</h2>

    <div *ngIf="esRRHH" class="rrhh-warning">
        <p class="error-msg">Los usuarios de RRHH no pueden solicitar vacaciones. Por favor usa la opción "Solicitudes de Vacaciones" para gestionar las solicitudes de la empresa.</p>
    </div>

    <form (submit)="onSubmit()" class="leave-form" *ngIf="!esRRHH">

        <div class="form-group">
            <label>Tipo de Permiso:</label>
            <select [(ngModel)]="solicitud.tipo_ausencia" name="tipo" required>
                <option value="" disabled selected>Selecciona una opción...</option>
                <option *ngFor="let t of tipos" [value]="t.id">
                    {{ t.nombre }} {{ t.requiere_soporte ? '(Requiere adjunto)' : '' }}
                </option>
            </select>
        </div>

        <div class="dates-row">
            <div class="form-group">
                <label>Desde:</label>
                <input type="date" [(ngModel)]="solicitud.fecha_inicio" name="inicio" required>
            </div>

            <div class="form-group">
                <label>Hasta:</label>
                <input type="date" [(ngModel)]="solicitud.fecha_fin" name="fin" required>
            </div>
        </div>

        <div class="form-group">
            <label>Motivo / Observación:</label>
            <textarea [(ngModel)]="solicitud.motivo" name="motivo" rows="3" required
                placeholder="Ej: Consulta médica de rutina..."></textarea>
        </div>

        <div class="form-group">
            <label>Documento de Soporte (PDF/Img):</label>
            <input type="file" (change)="onFileSelected($event)">
        </div>

        <p *ngIf="mensajeError" class="error-msg">{{ mensajeError }}</p>

        <div class="actions">
            <button type="button" (click)="router.navigate(['/home'])" class="btn-cancel">Cancelar</button>
            <button type="submit" [disabled]="cargando" class="btn-submit">
                {{ cargando ? 'Enviando...' : 'Enviar Solicitud' }}
            </button>
        </div>

    </form>
</div>